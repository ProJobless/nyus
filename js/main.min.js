/*!
*
* Copyright (c) David Bushell | http://dbushell.com/
*
*/function findIgnores(){var e=$("a");$ignoreMe=e.filter(function(e){return $(this).attr("rel")==="ignore"});return $ignoreMe}function getDocHeight(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function infiniteScroll(){var e=$(window),t=function(){e.scrollTop()+e.height()>getDocHeight()-100;setTimeout(t,500)};setTimeout(t,500)}function processfile(e){if(!/image/i.test(e.type)){alert("File "+e.name+" is not an image.");return!1}var t=new FileReader;t.readAsArrayBuffer(e);t.onload=function(t){var n=new Blob([t.target.result],{type:e.type});window.URL=window.URL||window.webkitURL;var r=window.URL.createObjectURL(n),i=new Image;i.src=r;i.onload=function(){resized=resizeMe(i);var t=document.createElement("input");t.type="hidden";t.name=e.name;t.value=resized;form.appendChild(t)}}}function readfiles(e){var t=document.getElementsByName("images[]"),n=document.getElementsByTagName("canvas");while(t.length>0){form.removeChild(t[0]);preview.removeChild(n[0])}for(var r=0;r<e.length;r++)processfile(e[r]);fileinput.value=""}function resizeMe(e){var t=document.createElement("canvas"),n=e.width,r=e.height;if(n>r){if(n>max_width){r=Math.round(r*=max_width/n);n=max_width}}else if(r>max_height){n=Math.round(n*=max_height/r);r=max_height}t.width=n;t.height=r;var i=t.getContext("2d");i.drawImage(e,0,0,n,r);preview.appendChild(t);return t.toDataURL("image/jpeg",.7)}function sendFile(e){var t="post/post",n=new XMLHttpRequest,r=new FormData;n.open("POST",t,!0);n.onreadystatechange=function(){n.readyState==4&&n.status==200&&alert(n.responseText)};r.append("myFile",e);n.send(r)}function updateSize(e){var t=e.size,n=t+" bytes";for(var r=["KB","MB"],i=0,s=t/1024;s>1;s/=1024,i++)n=s.toFixed(2)+" "+r[i];return n}function checkFileSize(e){var t,n,r,i=/image.*/,s=/video.*/,o=/audio.*/;if(e.type.match(i)){n=25e5;r="2.5 MB";t=document.getElementById("photo-input")}else if(e.type.match(o)){n=1e7;r="10 MB";t=document.getElementById("audio-input")}else{n=15e6;r="15 MB";t=document.getElementById("video-input")}if(e.size>n){try{$("#size").html("Too Big! Choose another file");$("#submit").prop("disabled",!0)}catch(u){}return}$("#submit").prop("disabled",!1);return t}function handleFiles(e,t){var n=e.files[0],r=n.name,i=$(t),s=new FileReader,o=$("<button/>").attr({"class":"clear",id:"clear",type:"button"}).html("Revert"),e=checkFileSize(n),u=updateSize(n);if(e.className.match("photo")){if(!!i.find("img").length)var a=i.find("img").detach();var f=document.createElement("img");f.classList.add("thumb");f.file=n;i.prepend(f);s.onload=function(e){return function(t){e.src=t.target.result}}(f);s.readAsDataURL(n)}!$("#size").length||i.children("#size").html("<strong>Filename:</strong> "+r+"<br> <strong>Filesize:</strong> "+u).append(o).on("click","#clear",function(){fileClear(a)});if(!!$(".upload-buttons").length){$notSelected=$("input[type=file]").not(e);$notSelected.parent().addClass("disabled");$notSelected.prop("disabled",!0)}$(e).hasClass("photo-input")&&$(e).siblings("#profile-select").toggleClass("visuallyhidden")}function fileClear(e){$("#profile-select").toggleClass("visuallyhidden");$inputs=$("input[type=file]");$inputs.val("").prop("disabled",!1);$inputs.parent().removeClass("disabled");var t=$("<span/>").addClass("size").attr("id","size");$("#preview").find("img, #size").remove();$("#preview").prepend(e,t)}(function(e,t,n){var r=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},i=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},s=function(e,t){i(e,t)||(e.className=e.className===""?t:e.className+" "+t)},o=function(e,t){e.className=r((" "+e.className+" ").replace(" "+t+" "," "))},u=function(e,t){if(e)do{if(e.id===t)return!0;if(e.nodeType===9)break}while(e=e.parentNode);return!1},a=t.documentElement,f=e.Modernizr.prefixed("transform"),l=e.Modernizr.prefixed("transition"),c=function(){var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};return e.hasOwnProperty(l)?e[l]:!1}();e.App=function(){var n=!1,r={},f=t.getElementById("page"),h=!1,p="js-nav";r.init=function(){if(n)return;n=!0;var d=function(e){e&&e.target===f&&t.removeEventListener(c,d,!1);h=!1};r.closeNav=function(){if(h){var n=c&&l?parseFloat(e.getComputedStyle(f,"")[l+"Duration"]):0;n>0?t.addEventListener(c,d,!1):d(null)}o(a,p)};r.openNav=function(){if(h)return;s(a,p);h=!0};r.toggleNav=function(e){h&&i(a,p)?r.closeNav():r.openNav();e&&e.preventDefault()};try{t.getElementById("menu-btn").addEventListener("click",r.toggleNav,!1)}catch(v){console.log(v)}t.addEventListener("click",function(e){if(h&&!u(e.target,"nav")){e.preventDefault();r.closeNav()}},!0);s(a,"js-ready")};return r}();e.addEventListener&&e.addEventListener("DOMContentLoaded",e.App.init,!1)})(window,window.document);var fileinput=document.getElementById("photo-input"),max_width=fileinput.getAttribute("data-maxwidth"),max_height=fileinput.getAttribute("data-maxheight"),preview=document.getElementById("preview"),canvas=document.getElementById("canvas"),form=document.getElementById("form");fileinput.onchange=function(){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){alert("The File APIs are not fully supported in this browser.");return!1}readfiles(fileinput.files)};$(document).ready(function(){findIgnores();$ignoreMe.on("click",function(e){e.preventDefault()});infiniteScroll();$("#actions").hasClass("open");$("#edit-details").click(function(e){e.preventDefault();if(!$("#instructions").length){if(!!$("#info").length){$("#form, #info").toggleClass("visuallyhidden");$("#clear").length||$("#profile-select").toggleClass("visuallyhidden")}}else{$("#form, #instructions").toggleClass("visuallyhidden");$("#clear").length||$("#profile-select").toggleClass("visuallyhidden");$("#next").prop("disabled",!1)}$(this).toggleClass("open")});$(".attach-media, #profile-select").click(function(){$(this).siblings("input").click()});try{!!document.URL.match(/setup/).length}catch(e){}var t={title:{},closeClick:!0,overlay:{css:{background:"black"}}};$(".posted-img").fancybox({helpers:t});$(".posted-audio, .posted-video").click(function(e){e.preventDefault();path=$(this).attr("data-path");audio=$(this).attr("data-audio");width=window.innerWidth;$.fancybox(this,{type:"ajax",ajax:{type:"POST",data:"path="+path+"&audio="+audio+"&width="+width},helpers:t})});$("#notifications a").click(function(e){e.preventDefault();memberId=$(this).attr("data-member");statusToLoad=$(this).attr("data-related-status");$.fancybox(this,{type:"ajax",ajax:{type:"POST",data:"memberid="+memberId+"&status="+statusToLoad},helpers:t})});$("#notifications-icon").click(function(){$(".notifications-count").addClass("viewed")});$("#actions-icon").click(function(){$(".actions-count").addClass("viewed")});$("#notifications-icon, #actions-icon, .attach-media, #profile-select").click(function(e){e.preventDefault()})});