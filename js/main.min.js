/*!
*
* Copyright (c) David Bushell | http://dbushell.com/
*
*/function findIgnores(){var e=$("a");$ignoreMe=e.filter(function(e){return $(this).attr("rel")==="ignore"});return $ignoreMe}function getDocHeight(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function infiniteScroll(){var e=$(window),t=function(){e.scrollTop()+e.height()>getDocHeight()-100;setTimeout(t,500)};setTimeout(t,500)}function fileClear(e){var t=$("input[type=hidden], canvas");!t.length||$(t).remove();$("#profile-select").toggleClass("visuallyhidden");var n=$("input[type=file]");n.val("").prop("disabled",!1);n.parent().removeClass("disabled");var r=$("<span/>").addClass("size").attr("id","size");$("#preview").find("img, #size").remove();$("#preview").prepend(e,r)}function getSize(e){var t=e.size,n=t+" bytes";for(var r=["KB","MB"],i=0,s=t/1024;s>1;s/=1024,i++)n=s.toFixed(2)+" "+r[i];return size}function checkFileSize(e){var t,n,r,i=/image.*/,s=/video.*/,o=/audio.*/;if(e.type.match(i)){n=25e5;r="2.5 MB";input=document.getElementById("photo-input")}else if(e.type.match(o)){n=1e7;r="10 MB";input=document.getElementById("audio-input")}else{n=15e6;r="15 MB";input=document.getElementById("video-input")}if(e.size>n){try{$("#size").html("Too Big! Choose another file");$("#submit").prop("disabled",!0)}catch(u){}return}$("#submit").prop("disabled",!1);return t}(function(e,t,n){var r=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},i=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},s=function(e,t){i(e,t)||(e.className=e.className===""?t:e.className+" "+t)},o=function(e,t){e.className=r((" "+e.className+" ").replace(" "+t+" "," "))},u=function(e,t){if(e)do{if(e.id===t)return!0;if(e.nodeType===9)break}while(e=e.parentNode);return!1},a=t.documentElement,f=e.Modernizr.prefixed("transform"),l=e.Modernizr.prefixed("transition"),c=function(){var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};return e.hasOwnProperty(l)?e[l]:!1}();e.App=function(){var n=!1,r={},f=t.getElementById("page"),h=!1,p="js-nav";r.init=function(){if(n)return;n=!0;var d=function(e){e&&e.target===f&&t.removeEventListener(c,d,!1);h=!1};r.closeNav=function(){if(h){var n=c&&l?parseFloat(e.getComputedStyle(f,"")[l+"Duration"]):0;n>0?t.addEventListener(c,d,!1):d(null)}o(a,p)};r.openNav=function(){if(h)return;s(a,p);h=!0};r.toggleNav=function(e){h&&i(a,p)?r.closeNav():r.openNav();e&&e.preventDefault()};try{t.getElementById("menu-btn").addEventListener("click",r.toggleNav,!1)}catch(v){console.log(v)}t.addEventListener("click",function(e){if(h&&!u(e.target,"nav")){e.preventDefault();r.closeNav()}},!0);s(a,"js-ready")};return r}();e.addEventListener&&e.addEventListener("DOMContentLoaded",e.App.init,!1)})(window,window.document);(function(){function l(e,t){var r=e.files;!n.length||$(n).remove();for(var i=0;i<r.length;i++)c(r[i],t);e.value="";if(!!$(".upload-buttons").length){$notSelected=$("input[type=file]").not(t);$notSelected.parent().addClass("disabled");$notSelected.prop("disabled",!0)}$(t).hasClass("photo-input")&&$(t).siblings("#profile-select").toggleClass("visuallyhidden")}function c(e,n){u.name=e.name;u.type=e.type;if(n.className.match("photo")&&!!r.find("img").length)var s=r.find("img").detach();var o=new FileReader;o.readAsArrayBuffer(e);o.onload=function(e){var n=document.getElementById("form"),r=new Blob([e.target.result],{type:u.type});window.URL=window.URL||window.webkitURL;var s=window.URL.createObjectURL(r);i.src=s;i.onload=function(){!$("input[type=hidden]").length||$("input[type=hidden]").remove();u.image=p(this,u.type);$("#thumb").prepend(this);$("#preview").append(t);h()}}}function h(){for(prop in u){var e=document.createElement("input");if(u.hasOwnProperty(prop)){e.type="hidden";e.name="images["+prop+"]";e.value=u[prop];form.appendChild(e)}}}function p(t,n){var r=a.getAttribute("data-maxwidth"),i=a.getAttribute("data-maxheight"),s=t.width,o=t.height;if(s>o){if(s>r){o=Math.round(o*=r/s);s=r}}else if(o>i){s=Math.round(s*=i/o);o=i}e.width=s;e.height=o;ctx=e.getContext("2d");ctx.drawImage(t,0,0,s,o);return e.toDataURL(n,.7)}var e=document.createElement("canvas"),t=$("<button/>").attr({"class":"clear",id:"clear",type:"button"}).html("Clear"),n=$("input[type=hidden], canvas"),r=$("#preview"),i=new Image,s=Math.PI/180,o=0,u={};try{var a=document.getElementById("photo-input");a.onchange=function(){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){alert("The File APIs are not fully supported in this browser.");return!1}l(a,this);$(".photo-control").removeClass("visuallyhidden")}}catch(f){}window.rotate=function(t){console.log(o);if(t==="left"){o===0&&(o=360);o-=90}else if(t==="right"){o===360&&(o=0);o+=90}var n=e.width,r=e.height,a=0,f=0;switch(o){case 0:n=e.width;r=e.height;iw=e.width;ih=e.height;break;case 90:n=e.height;r=e.width;f=e.height*-1;iw=r;ih=n;break;case 180:a=e.width*-1;f=e.height*-1;break;case 270:n=e.height;r=e.width;a=e.height*-1}ctx.clearRect(0,0,e.width,e.height);e.width=n;e.height=r;ctx.rotate(o*s);ctx.drawImage(i,a,f,iw,ih);$("#thumb img").attr("class","rotate"+o);!$("input[type=hidden]").length||$("input[type=hidden]").remove();u.image=e.toDataURL(u.type,1);h()}})();$(document).ready(function(){findIgnores();$ignoreMe.on("click",function(e){e.preventDefault()});infiniteScroll();$("#actions").hasClass("open");$("#edit-details").click(function(e){e.preventDefault();if(!$("#instructions").length){if(!!$("#info").length){$("#form, #info").toggleClass("visuallyhidden");$("#clear").length||$("#profile-select").toggleClass("visuallyhidden")}}else{$("#form, #instructions").toggleClass("visuallyhidden");$("#clear").length||$("#profile-select").toggleClass("visuallyhidden");$("#next").prop("disabled",!1)}$(this).toggleClass("open")});$("#preview").on("click","#clear",function(e){fileClear();$(this).detach()});$(".attach-media, #profile-select").click(function(){$(this).siblings("input").click()});try{!!document.URL.match(/setup/).length}catch(e){}var t={title:{},closeClick:!0,overlay:{css:{background:"black"}}};$(".posted-img").fancybox({helpers:t});$(".posted-audio, .posted-video").click(function(e){e.preventDefault();path=$(this).attr("data-path");audio=$(this).attr("data-audio");width=window.innerWidth;$.fancybox(this,{type:"ajax",ajax:{type:"POST",data:"path="+path+"&audio="+audio+"&width="+width},helpers:t})});$("#notifications a").click(function(e){e.preventDefault();memberId=$(this).attr("data-member");statusToLoad=$(this).attr("data-related-status");$.fancybox(this,{type:"ajax",ajax:{type:"POST",data:"memberid="+memberId+"&status="+statusToLoad},helpers:t})});$("#notifications-icon").click(function(){$(".notifications-count").addClass("viewed")});$("#actions-icon").click(function(){$(".actions-count").addClass("viewed")});$("#notifications-icon, #actions-icon, .attach-media, #profile-select").click(function(e){e.preventDefault()})});